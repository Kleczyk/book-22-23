\documentclass[../main.tex]{subfiles}




\begin{document}

\chapter{}
\label{cha:cha_9}


\section{}
The flop counts for $L U$ decomposition can be determined in a similar fashion as was done for Gauss elimination. \smallbreak The major difference is that the elimination is only implemented for the left-hand side coefficients. Thus, for\smallbreak every iteration of the inner loop, there are $n$ multiplications/divisions and $n-1$ addition/subtractions. The\smallbreak computations can be summarized as
\bigbreak
\begin{tabular}{cccc}
\Xhline{1.5pt}
Outer Loop $k$ & Inner Loop i & Addition/Subtraction flops & Multiplication/Division flops \\
\hline
1 & $2, n$ & $(n-1)(n-1)$ & $(n-1) n$ \\
2 & $3, n$ & $(n-2)(n-2)$ & $(n-2)(n-1)$ \\
$\cdot$ & $\cdot$ &  &  \\
$\cdot$ & $\cdot$ &  &  \\
$\cdot$ & $\cdot$ &  &  \\
$k$ & $k+1, n$ & $(n-k)(n-k)$ & $(n-k)(n+1-k)$ \\
$\cdot$ & $\cdot$ &  &  \\
$\cdot$ & $\cdot$ &  &  \\
$\cdot$ & $\cdot$ &  &  \\
$n-1$ & $n, n$ & $(1)(1)$ & (1)(2)  \\
\Xhline{1.5pt}
\end{tabular}
\bigbreak
Therefore, the total addition/subtraction flops for elimination can be computed as
\bigbreak$
\begin{aligned}
\sum_{k=1}^{n-1}(n-k)(n-k)=\sum_{k=1}^{n-1}\left[n^{2}-2 n k+k^{2}\right]
\end{aligned}$
\bigbreak
Applying some of the relationships from Eq. (8.14) yields
\bigbreak$
\begin{aligned}
\sum_{k=1}^{n-1}\left[n^{2}-2 n k+k^{2}\right]=\dfrac{n^{3}}{3}-\dfrac{n^{2}}{2}+\dfrac{n}{6}
\end{aligned}$
\bigbreak
A similar analysis for the multiplication/division flops yields
\bigbreak$
\begin{aligned}
&\sum_{k=1}^{n-1}(n-k)(n+1-k)=\dfrac{n^{3}}{3}-\dfrac{n}{3} \\
&{\left[n^{3}+O\left(n^{2}\right)\right]-\left[n^{3}+O(n)\right]+\left[\dfrac{1}{3} n^{3}+O\left(n^{2}\right)\right]=\dfrac{n^{3}}{3}+O\left(n^{2}\right)}
\end{aligned}$
\bigbreak
Summing these results gives
\bigbreak
$\dfrac{2 n^{3}}{3}-\dfrac{n^{2}}{2}-\dfrac{n}{6}$
\bigbreak
For forward substitution, the numbers of multiplications and subtractions are the same and equal to
\bigbreak$
\begin{aligned}\sum_{i=1}^{n-1} i=\dfrac{(n-1) n}{2}=\dfrac{n^{2}}{2}-\dfrac{n}{2}
\end{aligned}$
\bigbreak
Back substitution is the same as for Gauss elimination: $n^{2} / 2-n / 2$\smallbreak subtractions and $n^{2} / 2+$ $n / 2$ multiplications/divisions. The entire number of flops can be summarized as
\bigbreak
\begin{tabular}{|l|c|c|c|}
\hline
 & \textbf{Mult/Div} & \textbf{Add/Subtr} & \textbf{Total} \\
\hline
\\
\textbf{Forward elimination} & $\dfrac{n^{3}}{3}-\dfrac{n}{3}$ & $\dfrac{n^{3}}{3}-\dfrac{n^{2}}{2}+\dfrac{n}{6}$ & $\dfrac{2 n^{3}}{3}-\dfrac{n^{2}}{2}-\dfrac{n}{6}$ \\
\hline
\\
\textbf{Forward substitution} & $\dfrac{n^{2}}{2}-\dfrac{n}{2}$ & $\dfrac{n^{2}}{2}-\dfrac{n}{2}$ & $n^{2}-n$ \\
\hline
\\
\textbf{Back substitution} & $\dfrac{n^{2}}{2}+\dfrac{n}{2}$ & $\dfrac{n^{2}}{2}-\dfrac{n}{2}$ & $n^{2}$ \\
\hline
\\
\textbf{Total} & $\dfrac{n^{3}}{3}+n^{2}-\dfrac{n}{3}$ & $\dfrac{n^{3}}{3}+\dfrac{n^{2}}{2}-\dfrac{5 n}{6}$ & $\dfrac{2 n^{3}}{3}+\dfrac{3 n^{2}}{2}-\dfrac{7 n}{6}$ \\
\hline
\end{tabular}
\bigbreak
The total number of flops is identical to that obtained with standard Gauss elimination.
\bigbreak


\section{}
Equation (9.6) is
\bigbreak
[L]\{[U]\{x\}-\{d\}\}=[A]\{x\}-\{b\}
\bigbreak
Matrix multiplication is distributive, so the left-hand side can be rewritten as
\bigbreak
[L][U]\{x\}-[L]\{d\}=[A]\{x\}-\{b\}
\bigbreak
Equating the terms that are multiplied by $\{x\}$ yields,
\bigbreak
[L][U]\{x\}=[A]\{x\}
\bigbreak
and, therefore, Eq. (9.7) follows
\bigbreak
[L][U]=[A]
\bigbreak
Equating the constant terms yields Eq. (9.8)
\bigbreak
[L]\{d\}=\{b\}
\bigbreak


\section{}
The matrix to be evaluated is
\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
-3 & -6 & 2 \\
1 & 1 & 5
\end{array}\right]$
\bigbreak
Multiply the first row by $f_{21}=-3 / 10=-0.3$ and subtract the result from the second row to eliminate the $a_{21}$ \smallbreak term. Then, multiply the first row by $f_{31}=1 / 10=0.1$ and subtract the result from the third row to eliminate the \smallbreak$a_{31}$ term.The result is
\bigbreak\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0.8 & 5.1
\end{array}\right]$
\bigbreak\bigbreak
Multiply the second row by $f_{32}=0.8 /(-5.4)=-0.148148$ and subtract the result from the\smallbreak third row to eliminate the $a_{32}$ term.
\bigbreak\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]$
\bigbreak
Therefore, the $L U$ decomposition is
\bigbreak\bigbreak
$[L]\{U]=\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]$
\bigbreak\bigbreak
Multiplying $[L]$ and $[U]$ yields the original matrix as verified by the following MATLAB session,
\bigbreak
\begin{lstlisting}[numbers=none]
>> L = [1 0 0;-0.3 1 0;0.1 -0.148148 1];
>> U = [10 2 -1;0 -5.4 1.7;0 0 5.351852];
>> A = L*U

A =
 	 10.0000 2.0000 -1.0000
	 -3.0000 -6.0000 2.0000
 	  1.0000 1.0000 5.0000
\end{lstlisting}


\section{}
The $L U$ decomposition can be computed as
\bigbreak
$[L]\{U]=\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]$
\bigbreak
Forward substitution:
\bigbreak$
\begin{aligned}
&\{d\}=\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left\{\begin{array}{c}
27 \\
-61.5 \\
-21.5
\end{array}\right\} \\\\
&d_{1}=27 \\
&d_{2}=-61.5+0.3(27)=-53.4 \\
&d_{3}=-21.5-0.1(27)-(-0.148148)(-53.4)=-32.11111
\end{aligned}$
\bigbreak
Back substitution:
\bigbreak$
\begin{aligned}
&\{x\}=\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]\left\{\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right\}=\left\{\begin{array}{c}
27 \\
-53.5 \\
-32.11111
\end{array}\right. \\\\
&x_{3}=\dfrac{-32.11111}{5.351852}=-6 \\\\
&x_{2}=\dfrac{-53.4-1.7(-6)}{-5.4}=8 \\\\
&x_{1}=\dfrac{27-2(8)-(-1)(-6)}{10}=0.5
\end{aligned}$
\bigbreak
For the alternative right-hand-side vector, forward substitution is implemented as
\bigbreak$
\begin{aligned}
&\{d\}=\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left\{\begin{array}{c}
12 \\
18 \\
-6
\end{array}\right\} \\\\
&d_{1}=12 \\\\
&d_{2}=18+0.3(12)=21.6 \\\\
&d_{3}=-6-0.1(12)-(-0.148148)(18)=-4
\end{aligned}$
\bigbreak
\bigbreak
Back substitution:
\bigbreak
\bigbreak$
\begin{aligned}
&\{x\}=\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]\left\{\begin{array}{c}
12 \\
21.6 \\
-4
\end{array}\right\} \\\\
&x_{3}=\dfrac{-4}{5.351852}=-0.747405 \\\\
&x_{2}=\dfrac{21.6-1.7(-0.747405)}{-5.4}=-4.235294 \\\\
&x_{1}=\dfrac{12-2(-4.235294)-(-1)(-0.747405)}{10}=1.972318
\end{aligned}$
\bigbreak


\section{}
The system can be written in matrix form as
\bigbreak
$[A]=\left[\begin{array}{ccc}
2 & -6 & -1 \\
-3 & -1 & 7 \\
-8 & 1 & -2
\end{array}\right] \quad\quad\quad\{b\}=\left\{\begin{array}{c}
-38 \\
-34 \\
-20
\end{array}\right\}$
\bigbreak
Partial pivot:
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ -3 & -1 & 7 \\ 2 & -6 & -1\end{array} \mid\right]$\quad\quad\quad\quad
$\{b\}=\left\{\begin{array}{l}-20 \\ -34 \\ -38\end{array}\right\}$
\bigbreak
Forward eliminate
\bigbreak
$f_{21}=-3 /(-8)=0.375 \quad\quad\quad f_{31}=2 /(-8)=-0.25$
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -1.375 & 7.75 \\ 0 & -5.75 & -1.5\end{array}\right]$
\bigbreak
Pivot again
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -5.75 & -1.5 \\ 0 & -1.375 & 7.75\end{array}\right]$\quad\quad\quad
$\{b\}=\left\{\begin{array}{l}-20 \\ -38 \\ -34\end{array}\right\}$\bigbreak
$f_{21}=-0.25$\quad\quad\quad
$f_{31}=0.375$
\bigbreak
Forward eliminate
\bigbreak
$f_{32}=-1.375 /(-5.75)=0.23913$
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -5.75 & -1.5 \\ 0 & 0 & 8.108696\end{array}\right]$
\bigbreak
Therefore, the $L U$ decomposition is
\bigbreak

$[L]\{U]=\left[\begin{array}{c}1 \\ -0.25 \\ 0.375\end{array}\right.$
$\left.\begin{array}{cc}0 & 0 \\ 1 & 0 \\ 0.23913 & 1\end{array}\right]\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -5.75 & -1.5 \\ 0 & 0 & 8.108696\end{array}\right]$
\bigbreak
Forward elimination
\bigbreak$
\begin{aligned}
&\{d\}=\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.25 & 1 & 0 \\
0.375 & 0.23913 & 1
\end{array}\right]\left\{\begin{array}{l}
-20 \\
-38 \\
-34
\end{array}\right\}\\\\
&d_{1}=-20 \\
&d_{2}=-38-(-0.25)(-20)=-43 \\
&d_{3}=-34-0.375(-20)-0.23913(-43)=-16.21739
\end{aligned}$
\bigbreak
Back substitution:
\bigbreak$
\begin{aligned}
&{\left[\begin{array}{ccc}
-8 & 1 & -2 \\
0 & -5.75 & -1.5 \\
0 & 0 & 8.108696
\end{array}\right]\left\{\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right\}=\left\{\begin{array}{c}
-20 \\
-43 \\
-16.21739
\end{array}\right\}} \\\\
&x_{3}=\dfrac{-16.21739}{8.108696}=-2 \\\\
&x_{2}=\dfrac{-43-(-1.5)(-2)}{-5.75}=8 \\\\
&x_{1}=\dfrac{-20-1(8)-(-2)(-2)}{-8}=4
\end{aligned}$
\bigbreak


\section{}
Here is an M-file to generate the $L U$ decomposition without pivoting
\bigbreak
\begin{lstlisting}[numbers=none]
function [L, U] = LUNaive(A)
% LUNaive(A):
%   LU decomposition without pivoting.
% input:
%   A = coefficient matrix
% output:
%   L = lower triangular matrix
%   U = upper triangular matrix

[m,n] = size(A);
if m~=n, error('Matrix A must be square'); end
L = eye(n);
U = A;
% forward elimination
for k = 1:n-1
  for i = k+1:n
    L(i,k) = U(i,k)/U(k,k);
    U(i,k) = 0;
    U(i,k+1:n) = U(i,k+1:n)-L(i,k)*U(k,k+1:n);
  end
end
\end{lstlisting}
\bigbreak
Test with Prob. 9.3
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [10 2 -1;-3 -6 2;1 1 5];
>> [L,U] = LUnaive(A)

L =
 	  1.0000 		     0 		    0
 	 -0.3000 	  1.0000 		    0
 	  0.1000 	 -0.1481 	 1.0000
 	
U =
 	 10.0000 		2.0000 	-1.0000
 	   		 0	 -5.4000 	 1.7000
 	  		 0 		     0 	 5.3519 
\end{lstlisting}
\bigbreak
Verification that $[L][U]=[A]$.
\bigbreak
\begin{lstlisting}[numbers=none]
>> L*U

ans =
 	 10.0000   2.0000  -1.0000
 	 -3.0000  -6.0000   2.0000
 	  1.0000   1.0000   5.0000 
\end{lstlisting}
\bigbreak
Check using the \textit{ lu} function,
\bigbreak
\begin{lstlisting}[numbers=none]
>> [L,U]=lu(A)

L =
 	  1.0000 		    0 			 0
 	 -0.3000   1.0000 			 0
 	  0.1000  -0.1481 	1.0000
U =
 	 10.0000	 2.0000	 -1.0000
 	       0	-5.4000   1.7000
 		 		 0		    0		5.3519
\end{lstlisting}
\bigbreak

\section{}
The result of Example $9.4$ can be substituted into Eq. (9.14) to give
\bigbreak
$[A]=[U]^{T}[U]=\left[\begin{array}{ccc}2.44949 & & \\ 6.123724 & 4.1833 & \\ 22.45366 & 20.9165 & 6.110101\end{array}\right]\left[\begin{array}{ccc}2.44949 & 6.123724 & 22.45366 \\ & 4.1833 & 20.9165 \\ & & 6.110101\end{array}\right]$
\bigbreak
The multiplication can be implemented as in
\bigbreak$
\begin{aligned}
&a_{11}=2.44949^{2}=6.000001 \\
&a_{12}=6.123724 \times 2.44949=15 \\
&a_{13}=22.45366 \times 2.44949=55.00002 \\
&a_{21}=2.44949 \times 6.123724=15 \\
&a_{22}=6.123724^{2}+4.1833^{2}=54.99999 \\
&a_{22}=22.45366 \times 6.123724^{2}+20.9165 \times 4.1833=225 \\
&a_{31}=2.44949 \times 22.45366=55.00002 \\
&a_{32}=6.123724 \times 22.45366+4.1833 \times 20.9165=225 \\
&a_{33}=22.45366^{2}+20.9165^{2}+6.110101^{2}=979.0002
\end{aligned}$
\bigbreak


\section{}
\begin{enumerate}[label=\bfseries(\alph*)]
\item For the first row $(i=1)$, Eq. (9.15) is employed to compute
\bigbreak$
\begin{aligned}u_{11}=\sqrt{a_{11}}=\sqrt{8}=2.828427\end{aligned}$
\bigbreak
Then, Eq. (9.16) can be used to determine
\bigbreak$
\begin{aligned}
&u_{12}=\dfrac{a_{12}}{u_{11}}=\dfrac{20}{2.828427}=7.071068 \\\\
&u_{13}=\dfrac{a_{13}}{u_{11}}=\dfrac{15}{2.828427}=5.303301
\end{aligned}$
\bigbreak
For the second row $(i=2)$,
\bigbreak$
\begin{aligned}
&u_{22}=\sqrt{a_{22}-u_{12}^{2}}=\sqrt{80-(7.071068)^{2}}=5.477226 \\\\
&u_{23}=\dfrac{a_{23}-u_{12} u_{13}}{u_{22}}=\dfrac{50-7.071068(5.303301)}{5.477226}=2.282177
\end{aligned}$
\bigbreak
For the third row $(i=3)$,
\bigbreak
$u_{33}=\sqrt{a_{33}-u_{13}^{2}-u_{23}^{2}}=\sqrt{60-(5.303301)^{2}-(2.282177)^{2}}=5.163978$
\bigbreak
Thus, the Cholesky decomposition yields
\bigbreak
$[U]=\left[\begin{array}{lll}
2.828427 & 7.071068 & 5.303301 \\
& 5.477226 & 2.282177 \\
& & 5.163978
\end{array}\right]$
\bigbreak
The validity of this decomposition can be verified by substituting it and its transpose into Eq. (9.14) to see if their product yields the original matrix [A]. This is left for an exercise.
\bigbreak
\item 
\begin{lstlisting}[numbers=none]
>> A = [8 20 15;20 80 50;15 50 60];
>> U = chol(A)

U =
 	  2.8284 		7.0711 		5.3033
 			   0    5.4772    2.2822
 	       0         0 		5.1640 
\end{lstlisting}
\bigbreak
\item The solution can be obtained by hand or by MATLAB. Using MATLAB:
\bigbreak
\begin{lstlisting}[numbers=none]
>> b = [50;250;100];
>> d=U'\b

d =
	 17.6777
   22.8218
   -8.8756
   
>> x=U\d

x =
   -2.7344
    4.8828
   -1.7187
\end{lstlisting}
\bigbreak
\section{}
Here is an M-file to generate the Cholesky decomposition without pivoting
\bigbreak
\begin{lstlisting}[numbers=none]
function U = cholesky(A)
% cholesky(A):
%   cholesky decomposition without pivoting.
% input:
%   A = coefficient matrix
% output:
%   U = upper triangular matrix
[m,n] = size(A);
if m~=n, error('Matrix A must be square'); end
for i = 1:n
  s = 0;
  for k = 1:i-1
    s = s + U(k, i) ^ 2;
  end
  U(i, i) = sqrt(A(i, i) - s);
  for j = i + 1:n
    s = 0;
    for k = 1:i-1
		  s = s + U(k, i) * U(k, j);
 	  end
	  U(i, j) = (A(i, j) - s) / U(i, i);
  end
end 
\end{lstlisting}
\bigbreak
Test with Prob. $9.8$
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [8 20 15;20 80 50;15 50 60];
>> cholesky(A)

ans =
	  2.8284 		7.0711 		5.3033
 				 0 		5.4772 		2.2822
 				 0 			   0 		5.1640
\end{lstlisting}
\bigbreak
Check with the \textit{chol} function 
\bigbreak
\begin{lstlisting}[numbers=none]
>> U = chol(A)

U =
	  2.8284 		7.0711 	  5.3033
 	  	   0 		5.4772 	  2.2822
 	 	     0 		     0 	  5.1640
\end{lstlisting}


\end{enumerate}
\end{document}

