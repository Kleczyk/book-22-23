\documentclass[../main.tex]{subfiles}

\usepackage{makecell}
\usepackage{amsmath}

\titleformat{\section}
  {\normalsize\bfseries}{\thesection}{1em}{\normalfont}

\pagestyle{empty}

\setcounter{chapter}{9}
\pagenumbering{arabic}
\setcounter{page}{7}

\newenvironment{blockquote}{%
  \par%
  \medskip
  \leftskip=3.5em\rightskip=2em%
  \noindent\ignorespaces}{%
  \par\medskip}


\begin{document}

\chapter{}
\label{cha:cha_10}


\section{}


First, compute the $L U$ decomposition The matrix to be evaluated is
\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
-3 & -6 & 2 \\
1 & 1 & 5
\end{array}\right]$
\bigbreak
Multiply the first row by $f_{21}=-3 / 10=-0.3$ and subtract the result from the second row to\smallbreak eliminate the $a_{21}$ term. Then, multiply the first row by $f_{31}=1 / 10=0.1$ and subtract the\smallbreak result from the third row to eliminate the $a_{31}$ term. The result is
\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0.8 & 5.1
\end{array}\right]$
\bigbreak
Multiply the second row by $f_{32}=0.8 /(-5.4)=-0.148148$ and subtract the result from the break\smallbreak third row to eliminate the $a_{32}$ term.
\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]$
\bigbreak
Therefore, the $L U$ decomposition is
\bigbreak
$[L]\{U]=\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]$
\bigbreak
The first column of the matrix inverse can be determined by performing the forward-\smallbreak substitution solution procedure with a unit vector (with 1 in the first row) as the right-hand-\smallbreak side vector. Thus, the lower-triangular system, can be set up as,
\bigbreak
$\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left\{\begin{array}{l}
d_{1} \\
d_{2} \\
d_{3}
\end{array}\right\}=\left\{\begin{array}{l}
1 \\
0 \\
0
\end{array}\right\}$
\bigbreak
and solved with forward substitution for $\{d\}^{T}=\left\lfloor\begin{array}{lll}1 & 0.3 & -0.055556\end{array}\right\rfloor$. This vector can then\smallbreak  be used as the right-hand side of the upper triangular system,
\bigbreak
$\left[\begin{array}{ccc}
10 & 2 & -1 \\
0 & -5.4 & 1.7 \\
0 & 0 & 5.351852
\end{array}\right]\left\{\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right\}=\left\{\begin{array}{c}
1 \\
0.3 \\
-0.055556
\end{array}\right\}$
\bigbreak
which can be solved by back substitution for the first column of the matrix inverse,
\bigbreak
$[A]^{-1}=\left[\begin{array}{ccc}
0.110727 & 0 & 0 \\
-0.058824 & 0 & 0 \\
-0.010381 & 0 & 0
\end{array}\right]$
\bigbreak
To determine the second column, Eq. (9.8) is formulated as
\bigbreak
$\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.1 & -0.148148 & 1
\end{array}\right]\left\{\begin{array}{l}
d_{1} \\
d_{2} \\
d_{3}
\end{array}\right\}=\left\{\begin{array}{l}
0 \\
1 \\
0
\end{array}\right\}$
\bigbreak
This can be solved with forward substitution for $\{d\}^{T}=\left\lfloor\begin{array}{lll}0 & 1 & 0.148148\end{array}\right\rfloor$, and the results\smallbreak are used with $[U]$ to determine $\{x\}$ by back substitution to generate the second column of\smallbreak the matrix inverse,
\bigbreak
$[A]^{-1}=\left[\begin{array}{ccc}
0.110727 & 0.038062 & 0 \\
-0.058824 & -0.176471 & 0 \\
-0.010381 & 0.027682 & 0
\end{array}\right]$
\bigbreak
Finally, the same procedures can be implemented with $\{b\}^{T}=\left\lfloor\begin{array}{lll}0 & 0 & 1\end{array}\right\rfloor$ to solve for $\{d\}^{T}=$ \smallbreak$\left\lfloor\begin{array}{lll}0 & 0 & 1\end{array}\right\rfloor$, and the results are used with $[U]$ to determine $\{x\}$ by back substitution to\smallbreak generate the third column of the matrix inverse,
\bigbreak
$[A]^{-1}=\left[\begin{array}{ccc}
0.110727 & 0.038062 & 0.00692 \\
-0.058824 & -0.176471 & 0.058824 \\
-0.010381 & 0.027682 & 0.186851
\end{array}\right]$
\bigbreak
This result can be checked by multiplying it times the original matrix to give the identity \smallbreak matrix. The following MATLAB session can be used to implement this check,
\bigbreak
\begin{lstlisting}[numbers=none]	 	 
>> A = [10 2 -1;-3 -6 2;1 1 5];
>> AI = [0.110727 0.038062 0.00692;
-0.058824 -0.176471 0.058824;
-0.010381 0.027682 0.186851];
>> A*AI

ans =
	  1.0000  -0.0000 	-0.0000
	  0.0000 	 1.0000 	-0.0000
 	 -0.0000	 0.0000	   1.0000
\end{lstlisting}
\bigbreak


\section{}

The system can be written in matrix form as
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ 2 & -6 & -1 \\ -3 & -1 & 7\end{array}\right]$\quad\quad
$\{b\}=\left\{\begin{array}{l}-38 \\ -34 \\ -20\end{array}\right\}$
\bigbreak
Forward eliminate
\bigbreak
$f_{21}=2 /(-8)=-0.25 \quad \quad \quad f_{31}=-3 /(-8)=0.375$
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -5.75 & -1.5 \\ 0 & -1.375 & 7.75\end{array}\right]$
\bigbreak
Forward eliminate
\bigbreak
$f_{32}=-1.375 /(-5.75)=0.23913$
\bigbreak
$[A]=\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -5.75 & -1.5 \\ 0 & 0 & 8.108696\end{array}\right]$
\bigbreak
Therefore, the $L U$ decomposition is
\bigbreak
$[L]\{U]=\left[\begin{array}{ccc}1 & 0 & 0 \\ -0.25 & 1 & 0 \\ 0.375 & 0.23913 & 1\end{array}\right]\left[\begin{array}{ccc}-8 & 1 & -2 \\ 0 & -5.75 & -1.5 \\ 0 & 0 & 8.108696\end{array}\right]$
\bigbreak
The first column of the matrix inverse can be determined by performing the forward-\smallbreak substitution solution procedure with a unit vector (with 1 in the first row) as the right-hand-\smallbreak side vector. Thus, the lower-triangular system, can be set up as,
\bigbreak
$\left[\begin{array}{ccc}1 & 0 & 0 \\ -0.25 & 1 & 0 \\ 0.375 & 0.23913 & 1\end{array}\right]\left\{\begin{array}{l}d_{1} \\ d_{2} \\ d_{3}\end{array}\right\}=\left\{\begin{array}{l}1 \\ 0 \\ 0\end{array}\right\}$
\bigbreak
and solved with forward substitution for $\{d\}^{T}=\left\lfloor\begin{array}{lll}1 & 0.25 & -0.434783\end{array}\right\rfloor$. This vector can then\smallbreak be used as the right-hand side of the upper triangular system,
\bigbreak
$\left[\begin{array}{ccc}
-8 & 1 & -2 \\
0 & -5.75 & -1.5 \\
0 & 0 & 8.108696
\end{array}\right]\left\{\begin{array}{l}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right\}=\left\{\begin{array}{c}
1 \\
0.25 \\
-0.434783
\end{array}\right\}$
\bigbreak
which can be solved by back substitution for the first column of the matrix inverse,
\bigbreak
$[A]^{-1}=\left[\begin{array}{ccc}-0.115282 & 0 & 0 \\ -0.029491 & 0 & 0 \\ -0.053619 & 0 & 0\end{array}\right]$
\bigbreak
To determine the second column, Eq. (9.8) is formulated as
\bigbreak
$\left[\begin{array}{ccc}
1 & 0 & 0 \\
-0.25 & 1 & 0 \\
0.375 & 0.23913 & 1
\end{array}\right]\left\{\begin{array}{l}
d_{1} \\
d_{2} \\
d_{3}
\end{array}\right\}=\left\{\begin{array}{l}
0 \\
1 \\
0
\end{array}\right\}$
\bigbreak
This can be solved with forward substitution for $\{d\}^{T}=\left\lfloor\begin{array}{lll}0 & 1 & -0.23913\end{array}\right\rfloor$, and the results\smallbreak are used with $[U]$ to determine $\{x\}$ by back substitution to generate the second column of\smallbreak the matrix inverse,
\bigbreak
$[A]^{-1}=\left[\begin{array}{ccc}
-0.115282 & -0.013405 & 0 \\
-0.029491 & -0.16622 & 0 \\
-0.053619 & -0.029491 & 0
\end{array}\right]$
\bigbreak
Finally, the same procedures can be implemented with $\{b\}^{T}=\left\lfloor\begin{array}{lll}0 & 0 & 1\end{array}\right\rfloor$ to solve for $\{d\}^{T}=$\smallbreak $\left\lfloor\begin{array}{lll}0 & 0 & 1\end{array}\right\rfloor$, and the results are used with $[U]$ to determine $\{x\}$ by back substitution to\smallbreak generate the third column of the matrix inverse,
\bigbreak
$[A]^{-1}=\left[\begin{array}{ccc}
-0.115282 & -0.013405 & -0.034853 \\
-0.029491 & -0.16622 & -0.032172 \\
-0.053619 & -0.029491 & 0.123324
\end{array}\right]$
\bigbreak


\section{}
The following solution is generated with MATLAB.
\bigbreak
\begin{enumerate}[label=\bfseries(\alph*)]
\item
\begin{lstlisting}[numbers=none]	 	 
>> A = [15 -3 -1;-3 18 -6;-4 -1 12];
>> format long
>> AI = inv(A)

AI =
 	 0.07253886010363 	0.01278065630397 	0.01243523316062
	 0.02072538860104 	0.06079447322971 	0.03212435233161
	 0.02590673575130 	0.00932642487047 	0.09015544041451
\end{lstlisting}
\bigbreak
\item 
\begin{lstlisting}[numbers=none]	 	 
>> b = [3800 1200 2350]';
>> format short
>> c = AI*b

c =
 	320.2073
 	227.2021
	321.5026
\end{lstlisting}
\bigbreak
\item 
The impact of a load to reactor 3 on the concentration of reactor 1 is specified by the element $a_{13}^{-1}=0.0124352$. Therefore, the increase in the mass input to reactor 3 needed to induce a $10 \mathrm{~g} / \mathrm{m}^{3}$ rise in the concentration of reactor 1 can be computed as
\bigbreak
$\Delta b_{3}=\dfrac{10}{0.0124352}=804.1667 \dfrac{g}{d}$
\bigbreak
\item The decrease in the concentration of the third reactor will be
\bigbreak
$\Delta c_{3}=0.0259067(500)+0.009326(250)=12.9534+2.3316=15.285 \dfrac{\mathrm{g}}{\mathrm{m}^{3}}$
\bigbreak


\section{}

The mass balances can be written and the result written in matrix form as
\bigbreak
$\left[\begin{array}{ccccc}
6 & 0 & -1 & 0 & 0 \\
-3 & 3 & 0 & 0 & 0 \\
0 & -1 & 9 & 0 & 0 \\
0 & -1 & -8 & 11 & -2 \\
-3 & -1 & 0 & 0 & 4
\end{array}\right]\left\{\begin{array}{l}
c_{1} \\
c_{2} \\
c_{3} \\
c_{4} \\
c_{5}
\end{array}\right\}=\left\{\begin{array}{c}
Q_{01} c_{01} \\
0 \\
Q_{03} c_{03} \\
0 \\
0
\end{array}\right\}$
\bigbreak
MATLAB can then be used to determine the matrix inverse
\bigbreak
\begin{lstlisting}[numbers=none]
>> Q = [6 0 -1 0 0;-3 3 0 0 0;0 -1 9 0 0;0 -1 -8 11 -2;-3 -1 0 0 4];
>> inv(Q)

ans =
 		0.1698	 	0.0063 	  0.0189 				 0 			   0
 		0.1698 	  0.3396 	  0.0189 				 0 			   0 
 		0.0189 	  0.0377 	  0.1132 				 0 			   0
 		0.0600 	  0.0746 	  0.0875 		0.0909 		0.0455
		0.1698 	  0.0896 	  0.0189 				 0 		0.2500
\end{lstlisting}
\bigbreak
The concentration in reactor 5 can be computed using the elements of the matrix inverse as in,
\bigbreak
$c_{5}=a_{51}^{-1} Q_{01} c_{01}+a_{53}^{-1} Q_{03} c_{03}=0.1698(5) 20+0.0189(8) 50=16.981+7.547=24.528$
\bigbreak


\section{}

The problem can be written in matrix form as
\bigbreak
$\left[\begin{array}{cccccc}
0.866 & 0 & -0.5 & 0 & 0 & 0 \\
0.5 & 0 & 0.866 & 0 & 0 & 0 \\
-0.866 & -1 & 0 & -1 & 0 & 0 \\
-0.5 & 0 & 0 & 0 & -1 & 0 \\
0 & 1 & 0.5 & 0 & 0 & 0 \\
0 & 0 & -0.866 & 0 & 0 & -1
\end{array}\right]\left\{\begin{array}{c}
F_{1} \\
F_{2} \\
F_{3} \\
H_{2} \\
V_{2} \\
V_{3}
\end{array}\right\}=\left\{\begin{array}{c}
F_{1, h} \\
F_{1, v} \\
F_{2, h} \\
F_{2, v} \\
F_{3, h} \\
F_{3, v}
\end{array}\right\}$
\bigbreak
MATLAB can then be used to solve for the matrix inverse,
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [0.866 0 -0.5 0 0 0;
0.5 0 0.866 0 0 0;
-0.866 -1 0 -1 0 0;
-0.5 0 0 0 -1 0;
0 1 0.5 0 0 0;
0 0 -0.866 0 0 -1];
>> AI = inv(A)

AI =
  	0.8660 	  0.5000 			  0 			 0 			  0 			  0
 	  0.2500 	 -0.4330 			  0 			 0 	 1.0000 			  0
 	 -0.5000 	  0.8660 			  0 			 0			  0 			  0
	 -1.0000 	  0.0000  -1.0000 			 0 	-1.0000 				0
	 -0.4330 	 -0.2500 			  0  -1.0000 				0 				0
	  0.4330 	 -0.7500 			  0 		   0 			  0 	-1.0000
\end{lstlisting}
\bigbreak
The forces in the members resulting from the two forces can be computed using the\smallbreak elements of the matrix inverse as in,
\bigbreak$
\begin{aligned}
&F_{1}=a_{12}^{-1} F_{1, v}+a_{15}^{-1} F_{3, h}=0.5(-2000)+0(-500)=-1000+0=-1000 \\\\
&F_{2}=a_{22}^{-1} F_{1, v}+a_{25}^{-1} F_{3, h}=-0.433(-2000)+1(-500)=866-500=366 \\\\
&F_{3}=a_{32}^{-1} F_{1, v}+a_{35}^{-1} F_{3, h}=0.866(-2000)+0(-500)=-1732+0=-1732
\end{aligned}$
\bigbreak


\section{}
The matrix can be scaled by dividing each row by the element with the largest absolute value
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [8/(-10) 2/(-10) 1;1 1/(-9) 3/(-9);1 -1/15 6/15]

A =

	 -0.8000	 -0.2000	  1.0000
	  1.0000	 -0.1111	 -0.3333
	  1.0000	 -0.0667	  0.4000
\end{lstlisting}
\bigbreak
MATLAB can then be used to determine each of the norms,
\bigbreak
\begin{lstlisting}[numbers=none]
>> norm(A,'fro')

ans =
 		1.9920
 
>> norm(A,1)

ans =
 		2.8000
 
>> norm(A,inf)

ans =
	   2 
\end{lstlisting}
\bigbreak


\section{}
\underline{Prob. 10.2:}
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [-8 1 -2;2 -6 -1;-3 -1 7];
>> norm(A,'fro')

ans =
 	  13
 
>> norm(A,inf)

ans =
 	  11
\end{lstlisting}
\bigbreak
\underline{Prob. 10.3:}
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [15 -3 -1;-3 18 -6;-4 -1 12]
>> norm(A,'fro')

ans =
 	 27.6586
 
>> norm(A,inf)

ans =
 	  27


\end{lstlisting}
\bigbreak
\end{enumerate}


\section{}
\begin{enumerate}[label=\bfseries(\alph*)]
\item Spectral norm
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [1 4 9 16;4 9 16 25;9 16 25 36;16 25 36 49];
>> cond(A)

ans =
  8.8963e+016
\end{lstlisting}
\bigbreak
\item Row-sum norm
\bigbreak
\begin{lstlisting}[numbers=none]
>> cond(A,inf)

Warning: Matrix is close to singular or badly scaled.
				 Results may be inaccurate. RCOND = 3.037487e-019.
(Type "warning off MATLAB:nearlySingularMatrix" to suppress this
warning.)
> In cond at 45

ans =
  3.2922e+018
\end{lstlisting}
\end{enumerate}
\bigbreak


\section{}
\begin{enumerate}[label=\bfseries(\alph*)]
\item The matrix to be evaluated is
\bigbreak

$\left[\begin{array}{ccc}
16 & 4 & 1 \\
4 & 2 & 1 \\
49 & 7 & 1
\end{array}\right]$
\bigbreak
The row-sum norm of this matrix is $49+7+1=57$. The inverse is
\bigbreak
$\left[\begin{array}{ccc}-0.1667 & 0.1 & 0.0667 \\ 1.5 & -1.1 & -0.4 \\ -2.3333 & 2.8 & 0.5333\end{array}\right]$
\bigbreak
The row-sum norm of the inverse is $|-2.3333|+2.8+0.5333=5.6667$. Therefore, the condition number is
\bigbreak
Cond $[A]=57(5.6667)=323$
\bigbreak
This can be verified with MATLAB,
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [16 4 1;4 2 1;49 7 1];
>> cond(A,inf)

ans =
  323.0000
\end{lstlisting}
\bigbreak
\item\underline{Spectral norm:}
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = [16 4 1;4 2 1;49 7 1];
>> cond(A)

ans =
  216.1294 
\end{lstlisting}
\bigbreak
\underline{Frobenius norm:}
\bigbreak
\begin{lstlisting}[numbers=none]
>> cond(A,'fro')

ans =
  217.4843
\end{lstlisting}
\bigbreak


\section{}
The spectral condition number can be evaluated as
\bigbreak
\begin{lstlisting}[numbers=none]
>> A = hilb(10);
>> N = cond(A)

N =
  1.6025e+013
\end{lstlisting}
\bigbreak
The digits of precision that could be lost due to ill-conditioning can be calculated as
\bigbreak
\begin{lstlisting}[numbers=none]
>> c = log10(N)

c =
   13.2048 
\end{lstlisting}
\bigbreak
Thus, about 13 digits could be suspect. A right-hand side vector can be developed
corresponding to a solution of ones:
\bigbreak
\begin{lstlisting}[numbers=none]
>> b=[sum(A(1,:)); sum(A(2,:)); sum(A(3,:)); sum(A(4,:)); sum(A(5,:));
sum(A(6,:)); sum(A(7,:)); sum(A(8,:)); sum(A(9,:)); sum(A(10,:))]

b =
 		2.9290
 		2.0199
 		1.6032
 		1.3468
 		1.1682
 		1.0349
 		0.9307
 		0.8467
 		0.7773
 		0.7188
\end{lstlisting}
\bigbreak
The solution can then be generated by left division
\bigbreak
\begin{lstlisting}[numbers=none]
>> x = A\b

x =
 		1.0000
		1.0000
 		1.0000
 		1.0000
 		0.9999
 		1.0003
		0.9995
		1.0005
 		0.9997
 		1.0001
\end{lstlisting}
\bigbreak
The maximum and mean errors can be computed as
\bigbreak
\begin{lstlisting}[numbers=none]
>> e=max(abs(x-1))

e =
 	5.3822e-004
 
>> e=mean(abs(x-1))

e =
 	1.8662e-004
\end{lstlisting}
\bigbreak
Thus, some of the results are accurate to only about 3 to 4 significant digits. Because\smallbreak
MATLAB represents numbers to 15 significant digits, this means that about 11 to 12 digits
\smallbreak are suspect.
\bigbreak


\section{}
First, the Vandermonde matrix can be set up
\bigbreak
\begin{lstlisting}[numbers=none]
>> x1 = 4;x2=2;x3=7;x4=10;x5=3;x6=5;
>> A = [x1^5 x1^4 x1^3 x1^2 x1 1;x2^5 x2^4 x2^3 x2^2 x2 1;x3^5 x3^4
x3^3 x3^2 x3 1;x4^5 x4^4 x4^3 x4^2 x4 1;x5^5 x5^4 x5^3 x5^2 x5 1;x6^5
x6^4 x6^3 x6^2 x6 1]

A =
 			  1024 				 256 			   64 			16 			  4 			1
			    32 				  16 				  8 			 4			  2			  1
 		   16807 				2401		 	  343 			49 				7 			1
 		  100000 			 10000 			 1000 		 100 			 10 			1
 			   243 					81 			   27 			 9 				3			  1
 			  3125 				 625 			  125 		  25			  5 			1
\end{lstlisting} 
\bigbreak
The spectral condition number can be evaluated as 
\bigbreak
\begin{lstlisting}[numbers=none]
>> N = cond(A)

N =
 	1.4492e+007
\end{lstlisting} 
\bigbreak
The digits of precision that could be lost due to ill-conditioning can be calculated as
\bigbreak
\begin{lstlisting}[numbers=none]
>> c = log10(N)

c =
	  7.1611
\end{lstlisting} 
\bigbreak
Thus, about 7 digits might be suspect. A right-hand side vector can be developed
corresponding to a solution of ones: 
\bigbreak
\begin{lstlisting}[numbers=none]
>> b=[sum(A(1,:));sum(A(2,:));sum(A(3,:));sum(A(4,:));sum(A(5,:));
sum(A(6,:))]

b =
 				1365
 			 	  63
 			 19608
 			111111
				 364
			  3906 
\end{lstlisting} 
\bigbreak
The solution can then be generated by left division
\bigbreak
\begin{lstlisting}[numbers=none]
>> format long
>> x=A\b

x =
 	 1.00000000000000
 	 0.99999999999991
 	 1.00000000000075
	 0.99999999999703
	 1.00000000000542
   0.99999999999630 
\end{lstlisting} 
\bigbreak
The maximum and mean errors can be computed as
\bigbreak
\begin{lstlisting}[numbers=none]
>> e = max(abs(x-1))

e =
	  5.420774940034789e-012
 
>> e = mean(abs(x-1))

e =
 	  2.154110223528960e-012 
\end{lstlisting} 
\bigbreak
Some of the results are accurate to about 12 significant digits. Because MATLAB
\smallbreak represents numbers to about 15 significant digits, this means that about 3 digits are suspect.
\smallbreak Thus, for this case, the condition number tends to exaggerate the impact of ill-conditioning. 
\bigbreak



\end{enumerate}
\end{document}

